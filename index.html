<!DOCTYPE html>
<html lang="bn">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1" />
  <title>ALIM-26 Final Stage Preparation Course</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
  <link href="https://fonts.googleapis.com/css2?family=Tiro+Bangla:wght@400;700&family=Poppins:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
  <style>
    :root {
      --primary: #0ea5e9; /* ভাইব্রেন্ট সায়ান নীল - চকচকে প্রাইমারি */
      --primary-dark: #0369a1; /* গাঢ় সায়ান - ডেপ্থের জন্য */
      --secondary: #22c55e; /* ভাইব্রেন্ট সবুজ - এনার্জেটিক */
      --accent: #a855f7; /* ভাইব্রেন্ট পার্পল - অ্যাকসেন্টের জন্য */
      --danger: #ef4444; /* চকচকে লাল - এররের জন্য */
      --warning: #eab308; /* ভাইব্রেন্ট হলুদ - ওয়ার্নিং */
      --dark: #020617; /* গাঢ় কালো - ব্যাকগ্রাউন্ড */
      --darker: #000000; /* আরো গাঢ় - ডেপ্থ */
      --light: #f1f5f9; /* হালকা সাদা - লাইট এলিমেন্ট */
      --text: #f1f5f9; /* সাদা টেক্সট - ক্লিয়ার */
      --text-muted: #94a3b8; /* হালকা ধূসর - মিউটেড */
      --card-bg: rgba(15, 23, 42, 0.85); /* চকচকে গ্লাসি কার্ড - সামান্য নীল টিন্ট */
      --card-border: rgba(255, 255, 255, 0.2); /* হালকা সাদা বর্ডার */
      --glass: rgba(2, 6, 23, 0.75); /* গ্লাস ইফেক্ট - চকচকে */
      --glass-border: rgba(255, 255, 255, 0.25); /* সামান্য চকচকে বর্ডার */
      --gradient-primary: linear-gradient(135deg, #0ea5e9 0%, #22c55e 50%, #fde047 100%); /* চকচকে নীল-সবুজ-সোনালি গ্রেডিয়েন্ট */
      --gradient-secondary: linear-gradient(135deg, #a855f7 0%, #ec4899 50%, #f97316 100%); /* পার্পল-পিঙ্ক-কমলা - ভাইব্রেন্ট */
      --shadow-sm: 0 4px 12px rgba(0, 0, 0, 0.2); /* সামান্য শ্যাডো */
      --shadow-md: 0 10px 24px rgba(0, 0, 0, 0.3);
      --shadow-lg: 0 16px 32px rgba(0, 0, 0, 0.35);
      --shadow-xl: 0 24px 48px rgba(0, 0, 0, 0.4);
      --radius: 16px;
      --transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
      --font-primary: 'Poppins', sans-serif;
      --font-bangla: 'Tiro Bangla', serif;
    }

    * {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html, body {
      background: var(--darker);
      color: var(--text);
      font-family: var(--font-primary);
      line-height: 1.6;
      min-height: 100vh;
      overflow-x: hidden;
      scrollbar-width: none;
      -ms-overflow-style: none;
    }

    body::-webkit-scrollbar {
      display: none;
    }

    .bangla-font {
      font-family: var(--font-bangla);
    }

    a {
      color: inherit;
      text-decoration: none;
    }

    .container {
      max-width: 1280px;
      margin: 0 auto;
      padding: 24px;
    }

    header {
      position: sticky;
      top: 0;
      z-index: 1000;
      backdrop-filter: blur(20px) saturate(180%);
      background: rgba(2, 6, 23, 0.9); /* চকচকে গ্লাসি হেডার */
      border-bottom: 1px solid var(--card-border);
      box-shadow: var(--shadow-md);
    }

    .nav {
      display: flex;
      gap: 24px;
      align-items: center;
      justify-content: space-between;
      padding: 16px 24px;
    }

    .brand {
      display: flex;
      align-items: center;
      gap: 12px;
      font-weight: 800;
      letter-spacing: 0.5px;
      font-size: 1.6rem;
      color: var(--text);
      position: relative;
      transition: var(--transition);
    }

    .brand:hover {
      color: var(--primary);
      transform: translateY(-2px);
    }

    .tag {
      font-size: 0.85rem;
      font-weight: 600;
      background: var(--gradient-secondary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      padding: 6px 12px;
      border-radius: 20px;
      border: 1px solid var(--glass-border);
      backdrop-filter: blur(10px);
      box-shadow: var(--shadow-sm);
    }

    .searchbar {
      display: flex;
      gap: 12px;
      align-items: center;
      width: 100%;
      max-width: 500px;
      position: relative;
    }

    .searchbar input {
      width: 100%;
      padding: 14px 20px 14px 45px;
      border-radius: var(--radius);
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      outline: none;
      transition: var(--transition);
      backdrop-filter: blur(10px);
      font-size: 0.95rem;
      box-shadow: var(--shadow-sm);
    }

    .searchbar input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.2); /* চকচকে গ্লো ফোকাস */
    }

    .searchbar i {
      position: absolute;
      left: 18px;
      color: var(--text-muted);
      font-size: 1rem;
      transition: var(--transition);
    }

    .searchbar input:focus + i {
      color: var(--primary);
    }

    /* Search Results Styles */
    #search-results {
      margin: 10px 0;
      display: flex;
      flex-direction: column;
      gap: 5px;
      max-height: 300px;
      overflow-y: auto;
      background: var(--card-bg);
      border-radius: 12px;
      padding: 10px;
      box-shadow: var(--shadow-sm);
      display: none;
      position: absolute;
      top: 100%;
      left: 0;
      right: 0;
      z-index: 100;
    }

    .search-result-item {
      padding: 8px 12px;
      background: var(--glass);
      border-radius: 8px;
      cursor: pointer;
      transition: var(--transition);
      font-size: 0.9rem;
      color: var(--text);
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .search-result-item:hover {
      background: rgba(37, 99, 235, 0.1);
      transform: translateY(-2px);
    }

    .search-result-item .title {
      flex: 1;
    }

    .search-result-item .subject {
      font-size: 0.8rem;
      color: var(--text-muted);
    }

    /* Notice Bar Styles */
    .notice-bar {
      overflow: hidden;
      white-space: nowrap;
      background: rgba(37, 99, 235, 0.1);
      color: var(--warning);
      font-size: 0.8rem;
      padding: 6px 0;
      text-align: center;
      border-bottom: 1px solid var(--card-border);
      margin-top: 0;
      position: relative;
    }

    .notice-bar span {
      display: inline-block;
      animation: marquee 40s linear infinite 0s;
      padding-left: 100%;
    }

    @keyframes marquee {
      0% {
        transform: translateX(0);
      }
      100% {
        transform: translateX(-100%);
      }
    }

    /* Clock Styles */
    .clock-container {
      text-align: center;
      margin: 20px auto;
      padding: 25px 20px;
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      box-shadow: var(--shadow-md);
      backdrop-filter: blur(10px);
      max-width: 300px;
      width: 100%;
    }

    .clock-time {
      font-size: 1.8rem;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 5px;
    }

    .clock-time small {
      font-size: 0.5em;
      vertical-align: middle;
    }

    .clock-date {
      font-size: 0.9rem;
      color: var(--text-muted);
      font-weight: 500;
    }

    #exam-countdown {
      font-size: 0.9rem;
      color: var(--text-muted);
      font-weight: 500;
    }

    .clock-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-secondary);
    }

    .hero {
      text-align: center;
      padding: 80px 40px;
      margin: 40px 0;
      border-radius: var(--radius);
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      backdrop-filter: blur(15px);
      box-shadow: var(--shadow-xl);
      position: relative;
      overflow: hidden;
      animation: fadeIn 1s ease-out;
    }

    .hero::before {
      content: '';
      position: absolute;
      top: -50%;
      left: -50%;
      width: 200%;
      height: 200%;
      background: radial-gradient(circle, rgba(14, 165, 233, 0.15) 10%, transparent 40%); /* চকচকে গ্লো গ্রেডিয়েন্ট */
      animation: rotateGradient 20s linear infinite;
      z-index: -1;
    }

    @keyframes rotateGradient {
      0% { transform: rotate(0deg); }
      100% { transform: rotate(360deg); }
    }

    .hero h1 {
      font-size: 3.2rem;
      margin-bottom: 16px;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 800;
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.25);
    }

    .hero p {
      color: var(--text-muted);
      font-size: 1.2rem;
      max-width: 800px;
      margin: 0 auto;
      line-height: 1.8;
    }

    .stats {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(240px, 1fr));
      gap: 24px;
      margin: 48px 0;
    }

    .stat-card {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 32px 24px;
      text-align: center;
      backdrop-filter: blur(12px);
      transition: var(--transition);
      position: relative;
      overflow: hidden;
      cursor: pointer;
      box-shadow: var(--shadow-md);
    }

    .stat-card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--gradient-primary);
      opacity: 0.9;
      transition: var(--transition);
    }

    .stat-card:hover::before {
      height: 100%;
      opacity: 0.15; /* সল্প গ্লো */
    }

    .stat-card:hover {
      transform: translateY(-8px) scale(1.03);
      box-shadow: var(--shadow-xl);
    }

    .stat-number {
      font-size: 3rem;
      font-weight: 800;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 12px;
      line-height: 1;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
    }

    .stat-label {
      color: var(--text-muted);
      font-size: 1.1rem;
      font-weight: 500;
    }

    .today-classes-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin: 24px 0;
      background: var(--card-bg);
      border-radius: var(--radius);
      overflow: hidden;
      box-shadow: var(--shadow-lg);
      font-size: 0.9rem;
      border: 1px solid var(--card-border);
    }

    .today-classes-table th {
      background: var(--gradient-primary);
      color: white;
      padding: 12px 16px;
      text-align: left;
      font-weight: 600;
      font-size: 1rem;
    }

    .today-classes-table td {
      padding: 12px 16px;
      border-bottom: 1px solid var(--card-border);
      transition: var(--transition);
    }

    .today-classes-table tr:last-child td {
      border-bottom: none;
    }

    .today-classes-table tr:hover {
      background: rgba(255, 255, 255, 0.1); /* চকচকে হোভার */
      transform: translateX(4px);
    }

    .subject-badge {
      display: inline-block;
      padding: 4px 10px;
      border-radius: 20px;
      background: var(--primary);
      color: white;
      font-size: 0.8rem;
      font-weight: 500;
      box-shadow: var(--shadow-sm);
      transition: var(--transition);
    }

    .subject-badge:hover {
      background: var(--primary-dark);
    }

    .class-info {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .grid {
      display: grid;
      gap: 28px;
      grid-template-columns: repeat(auto-fill, minmax(340px, 1fr));
      margin-top: 32px;
    }

    .card {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 24px;
      backdrop-filter: blur(16px);
      transition: var(--transition);
      box-shadow: var(--shadow-md);
      position: relative;
      overflow: hidden;
      font-size: 0.95rem;
    }

    .card.highlight {
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.3), var(--shadow-xl); /* চকচকে হাইলাইট গ্লো */
      transform: scale(1.02);
    }

    .card::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--gradient-primary);
      opacity: 0.95;
      transition: var(--transition);
    }

    .card:hover::before {
      height: 100%;
      opacity: 0.25; /* সল্প গ্লো হোভার */
    }

    .card:hover {
      transform: translateY(-8px) scale(1.04);
      border-color: var(--primary);
      box-shadow: var(--shadow-xl);
    }

    .subject {
      font-weight: 700;
      margin-bottom: 12px;
      color: #7dd3fc; /* হালকা সায়ান - চকচকে */
      font-size: 1.1rem;
      display: flex;
      align-items: center;
      gap: 8px;
    }

    .time {
      color: var(--text-muted);
      font-size: 0.9rem;
      margin-bottom: 16px;
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .btn {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 20px;
      border-radius: 12px;
      border: none;
      background: var(--gradient-primary);
      color: white;
      font-weight: 600;
      transition: var(--transition);
      cursor: pointer;
      box-shadow: var(--shadow-md);
      position: relative;
      overflow: hidden;
      font-size: 0.9rem;
    }

    .btn::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 200%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.4), transparent); /* চকচকে শাইন ইফেক্ট */
      transition: left 0.5s ease;
    }

    .btn:hover::before {
      left: 100%;
    }

    .btn:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .btn.disabled {
      background: var(--text-muted);
      cursor: not-allowed;
      box-shadow: none;
      opacity: 0.7;
    }

    .btn.disabled:hover {
      transform: none;
      box-shadow: none;
    }

    .subj-list {
      display: grid;
      gap: 20px;
      grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
      margin-top: 32px;
    }

    .pill {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 16px 24px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 16px;
      transition: var(--transition);
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow-md);
      position: relative;
      overflow: hidden;
      font-size: 0.95rem;
    }

    .pill::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      width: 6px;
      height: 100%;
      background: var(--gradient-primary);
      opacity: 0;
      transition: var(--transition);
    }

    .pill:hover::before {
      opacity: 1;
    }

    .pill:hover {
      transform: translateY(-4px) scale(1.02);
      border-color: var(--primary);
      box-shadow: var(--shadow-lg);
    }

    .pill .go {
      padding: 8px 16px;
      border-radius: 10px;
      background: var(--gradient-primary);
      color: white;
      font-weight: 600;
      transition: var(--transition);
      font-size: 0.85rem;
    }

    .pill:hover .go {
      transform: translateX(4px);
      box-shadow: var(--shadow-sm);
    }

    .owner-wrap {
      max-width: 980px;
      margin: 32px auto 16px;
      padding: 24px;
      border-radius: var(--radius);
      background: linear-gradient(180deg, rgba(255, 255, 255, 0.05), rgba(255, 255, 255, 0.03)); /* চকচকে গ্রেডিয়েন্ট */
      border: 1px solid rgba(255, 255, 255, 0.1);
      display: flex;
      flex-direction: column;
      gap: 16px;
      align-items: center;
      text-align: center;
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow-lg);
    }

    .owner-messages {
      display: none;
    }

    .owner-intro {
      font-size: 1rem;
      color: var(--text-muted);
      max-width: 600px;
      line-height: 1.8;
      margin-bottom: 12px;
    }

    .owner-name {
      font-size: 1.4rem;
      font-weight: 800;
      margin-top: 8px;
      margin-bottom: 4px;
      background: linear-gradient(90deg, #a855f7, #ec4899, #22c55e); /* ভাইব্রেন্ট গ্রেডিয়েন্ট */
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-transform: none;
      letter-spacing: 0.5px;
    }

    .owner-sub {
      font-size: 0.85rem;
      color: rgba(226,232,240,0.8);
      margin-top: 0;
      margin-bottom: 8px;
      text-transform: lowercase;
    }

    .designer-credit {
      display: flex;
      gap: 8px;
      align-items: center;
      font-size: 0.8rem;
      color: var(--text);
      text-transform: none;
      font-weight: 600;
    }

    .designer-name {
      font-weight: 900;
      letter-spacing: 1px;
      text-transform: uppercase;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-size: 0.9rem;
      position: relative;
      padding: 4px 10px;
      border-radius: 8px;
      box-shadow: var(--shadow-sm);
    }

    .site-footer {
      max-width: 980px;
      margin: 16px auto 64px;
      padding: 20px 24px;
      border-radius: 12px;
      background: rgba(15,23,42,0.75); /* চকচকে ফুটার */
      border: 1px solid rgba(255,255,255,0.08);
      color: rgba(226,232,240,0.85);
      text-align: center;
      font-size: 0.85rem;
      box-shadow: var(--shadow-md);
    }

    @media (max-width: 768px) {
      .owner-name { font-size: 1.2rem; }
      .owner-messages { font-size: 0.75rem; gap: 8px; }
      .designer-credit { font-size: 0.75rem; }
      .owner-intro { font-size: 0.9rem; }

      .today-classes-table {
        font-size: 0.8rem;
      }

      .today-classes-table th,
      .today-classes-table td {
        padding: 8px 12px;
      }
    }

    .controls {
      display: flex;
      gap: 16px;
      align-items: center;
      margin-top: 24px;
    }

    .back-button {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 24px;
      padding: 12px 20px;
      background: var(--card-bg);
      border-radius: 12px;
      transition: var(--transition);
      border: 1px solid var(--card-border);
      backdrop-filter: blur(12px);
      font-size: 0.95rem;
      box-shadow: var(--shadow-sm);
    }

    .back-button:hover {
      background: rgba(14, 165, 233, 0.2); /* চকচকে হোভার */
      transform: translateX(-4px);
      border-color: var(--primary);
      box-shadow: var(--shadow-md);
    }

    .section-title {
      display: flex;
      align-items: center;
      gap: 12px;
      margin-top: 48px;
      margin-bottom: 24px;
      padding-bottom: 16px;
      border-bottom: 1px solid var(--card-border);
      position: relative;
    }

    .section-title::before {
      content: "";
      display: block;
      width: 6px;
      height: 32px;
      background: var(--gradient-primary);
      border-radius: 6px;
    }

    .section-title h2 {
      font-size: 1.8rem;
      font-weight: 700;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
    }

    .empty-state {
      text-align: center;
      padding: 48px 24px;
      color: var(--text-muted);
      grid-column: 1 / -1;
      font-size: 1rem;
    }

    .empty-state svg {
      width: 80px;
      height: 80px;
      margin-bottom: 16px;
      opacity: 0.7;
    }

    .loading {
      display: inline-block;
      width: 24px;
      height: 24px;
      border: 3px solid rgba(255, 255, 255, 0.35);
      border-radius: 50%;
      border-top-color: var(--primary);
      animation: spin 0.8s linear infinite;
    }

    @keyframes spin {
      to { transform: rotate(360deg); }
    }

    .notification {
      position: fixed;
      bottom: 40px;
      right: 40px;
      padding: 16px 24px;
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 12px;
      box-shadow: var(--shadow-lg);
      z-index: 1000;
      opacity: 0;
      transform: translateY(30px);
      transition: opacity 0.4s, transform 0.4s;
      backdrop-filter: blur(15px);
      display: flex;
      align-items: center;
      gap: 12px;
      max-width: 400px;
      font-size: 0.95rem;
    }

    .notification.show {
      opacity: 1;
      transform: translateY(0);
    }

    .notification.error {
      border-left: 5px solid var(--danger);
    }

    .notification.success {
      border-left: 5px solid var(--secondary);
    }

    .notification.warning {
      border-left: 5px solid var(--warning);
    }

    .card .video-title {
      font-size: 1rem;
      color: var(--text-muted);
      margin-bottom: 16px;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
      line-height: 1.6;
    }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(30px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .fade-in {
      animation: fadeIn 0.8s ease forwards;
    }

    @media (max-width: 968px) {
      .grid {
        grid-template-columns: repeat(auto-fill, minmax(300px, 1fr));
      }

      .hero h1 {
        font-size: 2.8rem;
      }

      .hero p {
        font-size: 1.1rem;
      }

      .today-classes-table {
        font-size: 0.85rem;
      }
    }

    @media (max-width: 768px) {
      .nav {
        flex-direction: column;
        gap: 16px;
      }

      .searchbar {
        max-width: 100%;
      }

      .grid {
        grid-template-columns: 1fr;
      }

      .subj-list {
        grid-template-columns: 1fr;
      }

      .section-title {
        margin-top: 32px;
      }

      .stats {
        grid-template-columns: 1fr;
      }

      .hero {
        padding: 40px 20px;
      }

      .hero h1 {
        font-size: 2rem;
      }

      .today-classes-table {
        display: block;
        overflow-x: auto;
      }

      .pill {
        padding: 14px 20px;
      }
    }

    .glow-effect {
      position: relative;
    }

    .glow-effect::after {
      content: '';
      position: absolute;
      top: -4px;
      left: -4px;
      right: -4px;
      bottom: -4px;
      z-index: -1;
      border-radius: inherit;
      background: var(--gradient-primary);
      background-size: 600% 600%;
      animation: gradientGlow 8s ease infinite; /* সল্প অ্যানিমেশন স্পিড */
      filter: blur(18px);
      opacity: 0.45; /* সল্প গ্লো */
    }

    @keyframes gradientGlow {
      0% { background-position: 0% 50%; }
      50% { background-position: 100% 50%; }
      100% { background-position: 0% 50%; }
    }

    #subject-page .container {
      padding-top: 32px;
    }

    #subject-title {
      font-size: 2rem;
      margin-bottom: 12px;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .filter-bar {
      display: flex;
      gap: 16px;
      margin-bottom: 24px;
      flex-wrap: wrap;
      justify-content: center;
      max-width: 600px;
      margin-left: auto;
      margin-right: auto;
    }

    .filter-bar select {
      padding: 10px 16px;
      border-radius: 10px;
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      outline: none;
      transition: var(--transition);
      backdrop-filter: blur(12px);
      min-width: 150px;
      font-size: 0.85rem;
      box-shadow: var(--shadow-sm);
    }

    .filter-bar input {
      padding: 14px 20px;
      border-radius: 12px;
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      outline: none;
      transition: var(--transition);
      backdrop-filter: blur(12px);
      min-width: 200px;
      font-size: 0.95rem;
      box-shadow: var(--shadow-sm);
    }

    .filter-bar input:focus, .filter-bar select:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.2);
    }

    .class-serial {
      position: absolute;
      top: 16px;
      right: 16px;
      font-size: 0.85rem;
      font-weight: 600;
      padding: 4px 10px;
      border-radius: 20px;
      background: var(--gradient-primary);
      color: white;
      box-shadow: var(--shadow-sm);
      transition: var(--transition);
    }

    .class-serial:hover {
      transform: scale(1.05);
      box-shadow: var(--shadow-md);
    }

    #login-page {
      background: var(--darker);
      color: var(--text);
      font-family: var(--font-primary);
      line-height: 1.6;
      min-height: 100vh;
      display: flex;
      align-items: center;
      justify-content: center;
      padding: 24px;
    }

    .login-container {
      width: 100%;
      max-width: 480px;
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 40px;
      backdrop-filter: blur(16px);
      box-shadow: var(--shadow-xl);
      position: relative;
      overflow: hidden;
    }

    .login-container::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 6px;
      background: var(--gradient-primary);
      z-index: 1;
    }

    .welcome-message {
      text-align: center;
      margin-bottom: 32px;
    }

    .welcome-message h1 {
      font-size: 2rem;
      margin-bottom: 12px;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 800;
      text-shadow: 0 4px 8px rgba(0, 0, 0, 0.25);
    }

    .welcome-message p {
      color: var(--text-muted);
      font-size: 1.1rem;
    }

    .login-form {
      margin-bottom: 32px;
    }

    .form-group {
      margin-bottom: 24px;
    }

    .form-group label {
      display: block;
      margin-bottom: 8px;
      font-weight: 500;
      color: var(--text);
    }

    .form-group input {
      width: 100%;
      padding: 16px 20px;
      border-radius: 12px;
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      outline: none;
      transition: var(--transition);
      font-size: 1rem;
      box-shadow: var(--shadow-sm);
    }

    .form-group input:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 4px rgba(14, 165, 233, 0.2);
    }

    .login-btn {
      width: 100%;
      padding: 16px;
      border-radius: 12px;
      border: none;
      background: var(--gradient-primary);
      color: white;
      font-weight: 600;
      font-size: 1rem;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-md);
    }

    .login-btn:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .support-info {
      text-align: center;
      margin-top: 32px;
      padding-top: 24px;
      border-top: 1px solid var(--card-border);
    }

    .support-info p {
      color: var(--text-muted);
      margin-bottom: 16px;
      font-size: 0.95rem;
    }

    .whatsapp-link {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 12px 24px;
      background: #25D366;
      color: white;
      border-radius: 50px;
      text-decoration: none;
      font-weight: 600;
      transition: var(--transition);
      box-shadow: var(--shadow-md);
    }

    .whatsapp-link:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    .error-message {
      color: var(--danger);
      text-align: center;
      margin-top: 16px;
      font-size: 0.95rem;
      display: none;
    }

    .warning-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.8); /* গাঢ় ওভারলে */
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.4s, visibility 0.4s;
    }

    .warning-modal.show {
      opacity: 1;
      visibility: visible;
    }

    .modal-content {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: var(--radius);
      padding: 40px;
      max-width: 560px;
      width: 90%;
      backdrop-filter: blur(20px);
      box-shadow: var(--shadow-xl);
    }

    .modal-header {
      text-align: center;
      margin-bottom: 24px;
    }

    .modal-header h2 {
      font-size: 1.6rem;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 12px;
      text-shadow: 0 2px 4px rgba(0, 0, 0, 0.25);
    }

    .modal-body {
      margin-bottom: 32px;
    }

    .modal-body p {
      color: var(--text-muted);
      line-height: 1.7;
      margin-bottom: 16px;
    }

    .modal-footer {
      text-align: center;
    }

    .modal-ok-btn {
      padding: 14px 40px;
      border-radius: 12px;
      border: none;
      background: var(--gradient-primary);
      color: white;
      font-weight: 600;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-md);
    }

    .modal-ok-btn:hover {
      transform: translateY(-4px);
      box-shadow: var(--shadow-lg);
    }

    @media (max-width: 480px) {
      .login-container {
        padding: 24px;
      }

      .welcome-message h1 {
        font-size: 1.6rem;
      }

      .modal-content {
        padding: 24px;
      }
    }

    #refresh-data-btn {
      margin-left: auto;
    }

    /* Loading Overlay Styles */
    #loading-overlay {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: var(--darker);
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      z-index: 9999;
      opacity: 1;
      visibility: visible;
      transition: opacity 0s, visibility 0s;
    }

    #loading-overlay.hidden {
      opacity: 0;
      visibility: hidden;
    }

    .loading-box {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 40px;
      text-align: center;
      max-width: 500px;
      width: 90%;
      backdrop-filter: blur(15px);
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow: hidden;
    }

    .loading-box::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-primary);
    }

    .loading-title {
      font-size: 1.5rem;
      margin-bottom: 20px;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      font-weight: 700;
    }

    .loading-message {
      color: var(--text-muted);
      margin-bottom: 25px;
      font-size: 1rem;
      line-height: 1.6;
    }

    .loading-spinner {
      width: 60px;
      height: 60px;
      border: 4px solid rgba(255, 255, 255, 0.1);
      border-radius: 50%;
      border-top-color: var(--primary);
      margin: 0 auto 20px;
      animation: spin 1.5s linear infinite;
    }

    .loading-progress {
      width: 100%;
      height: 8px;
      background: var(--glass);
      border-radius: 4px;
      overflow: hidden;
      margin-top: 20px;
    }

    .loading-progress-bar {
      height: 100%;
      background: var(--gradient-primary);
      width: 0%;
      transition: width 0.5s ease;
    }

    .loading-dots {
      display: inline-block;
      margin-left: 5px;
    }

    .loading-dots::after {
      content: '';
      animation: dots 1.5s steps(4, end) infinite;
    }

    @keyframes dots {
      0%, 20% { content: ''; }
      40% { content: '.'; }
      60% { content: '..'; }
      80%, 100% { content: '...'; }
    }

    /* Modal Styles */
    .modal {
      display: none;
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background-color: rgba(0, 0, 0, 0.5);
      justify-content: center;
      align-items: center;
      z-index: 1000;
      backdrop-filter: blur(5px);
    }

    .modal-content {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 16px;
      padding: 25px;
      max-width: 600px;
      width: 90%;
      backdrop-filter: blur(12px);
      box-shadow: var(--shadow-lg);
      position: relative;
      overflow-y: auto;
      max-height: 90vh;
      scroll-behavior: smooth;
    }

    .modal-content::before {
      content: '';
      position: absolute;
      top: 0;
      left: 0;
      right: 0;
      height: 4px;
      background: var(--gradient-primary);
    }

    .modal-close {
      position: absolute;
      top: 15px;
      right: 15px;
      background: none;
      border: none;
      color: var(--text-muted);
      font-size: 1.5rem;
      cursor: pointer;
      transition: var(--transition);
    }

    .modal-close:hover {
      color: var(--danger);
    }

    .modal-intro {
      margin-bottom: 20px;
      text-align: center;
    }

    .modal-intro h2 {
      font-size: 1.4rem;
      background: var(--gradient-primary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
      margin-bottom: 10px;
    }

    .modal-intro p {
      color: var(--text-muted);
      font-size: 0.9rem;
      line-height: 1.6;
    }

    .form-section {
      display: flex;
      flex-direction: column;
      gap: 25px;
    }

    .form-section label {
      font-weight: bold;
      font-size: 0.95rem;
      color: var(--text);
      text-align: left;
    }

    .form-section input, .form-section select, .form-section textarea {
      padding: 12px 16px;
      border-radius: 10px;
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      outline: none;
      transition: var(--transition);
      backdrop-filter: blur(10px);
      font-size: 0.9rem;
    }

    .form-section input:focus, .form-section select:focus, .form-section textarea:focus {
      border-color: var(--primary);
      box-shadow: 0 0 0 3px rgba(37, 99, 235, 0.2);
    }

    .form-section textarea {
      resize: vertical;
      min-height: 120px;
    }

    .submit-button {
      width: 100%;
      padding: 12px;
      border-radius: 10px;
      border: none;
      background: var(--gradient-primary);
      color: white;
      font-weight: 600;
      font-size: 0.95rem;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: 0 4px 10px rgba(37, 99, 235, 0.3);
      display: flex;
      align-items: center;
      justify-content: center;
      gap: 8px;
    }

    .submit-button:hover {
      transform: translateY(-2px);
      box-shadow: 0 6px 15px rgba(37, 99, 235, 0.4);
    }

    .submit-button.loading .spinner {
      display: inline-block;
    }

    .submit-button.loading {
      animation: none !important;
    }

    .spinner {
      display: none;
      width: 16px;
      height: 16px;
      border: 2px solid white;
      border-top: 2px solid transparent;
      border-radius: 50%;
      animation: spin 1s linear infinite;
    }

    .success-message {
      display: none;
      position: fixed;
      top: 50%;
      left: 50%;
      transform: translate(-50%, -50%);
      background: var(--secondary);
      color: white;
      padding: 20px 40px;
      border-radius: 10px;
      z-index: 2000;
      font-size: 1rem;
      box-shadow: var(--shadow-md);
      text-align: center;
      max-width: 80%;
    }

    .submissions-list, .reply-list, .sub-buttons {
      display: flex;
      flex-direction: column;
      gap: 15px;
      max-height: 60vh;
      overflow-y: auto;
      scroll-behavior: smooth;
    }

    .submission-item {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 10px;
      padding: 15px;
      box-shadow: var(--shadow-sm);
      transition: var(--transition);
    }

    .submission-item:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .submission-name {
      font-weight: 600;
      font-size: 1rem;
      color: var(--primary);
    }

    .submission-batch {
      font-size: 0.85rem;
      color: var(--text-muted);
    }

    .submission-message {
      margin-top: 10px;
      font-size: 0.9rem;
    }

    .submission-reply {
      margin-top: 10px;
      font-size: 0.9rem;
      border-top: 1px solid var(--card-border);
      padding-top: 10px;
      color: var(--secondary);
    }

    .submission-time {
      font-size: 0.75rem;
      color: var(--text-muted);
      margin-top: 5px;
      text-align: right;
    }

    .action-buttons {
      display: flex;
      justify-content: center;
      gap: 12px;
      margin-bottom: 20px;
    }

    .form-button, .submissions-button, .comment-button, .reply-button, .admin-button {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 12px;
      border-radius: 8px;
      border: none;
      background: var(--gradient-primary);
      color: white;
      font-weight: 600;
      font-size: 0.85rem;
      cursor: pointer;
      transition: var(--transition);
      box-shadow: var(--shadow-sm);
      position: relative;
      overflow: hidden;
    }

    .form-button:hover, .submissions-button:hover, .comment-button:hover, .reply-button:hover, .admin-button:hover {
      transform: translateY(-2px);
      box-shadow: var(--shadow-md);
    }

    .form-button::before, .submissions-button::before, .comment-button::before, .reply-button::before, .admin-button::before {
      content: '';
      position: absolute;
      top: 0;
      left: -100%;
      width: 100%;
      height: 100%;
      background: linear-gradient(90deg, transparent, rgba(255, 255, 255, 0.2), transparent);
      transition: 0.5s;
    }

    .form-button:hover::before, .submissions-button:hover::before, .comment-button:hover::before, .reply-button:hover::before, .admin-button:hover::before {
      left: 100%;
    }

    /* Dashboard Styles */
    .dashboard-modal {
      position: fixed;
      top: 0;
      left: 0;
      width: 100%;
      height: 100%;
      background: rgba(0, 0, 0, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      z-index: 2000;
      opacity: 0;
      visibility: hidden;
      transition: opacity 0.3s, visibility 0.3s;
    }

    .dashboard-modal.show {
      opacity: 1;
      visibility: visible;
    }

    .close-btn {
      position: absolute;
      top: 10px;
      right: 10px;
      font-size: 1.5rem;
      cursor: pointer;
      color: var(--text-muted);
    }

    .close-btn:hover {
      color: var(--text);
    }

    .badge-current {
      display: inline-block;
      padding: 5px 10px;
      border-radius: 20px;
      font-size: 0.8rem;
      margin-left: 10px;
      font-weight: 600;
    }

    .badge-starter {
      background: #6b7280;
      color: white;
    }

    .badge-bronze {
      background: #cd7f32;
      color: white;
    }

    .badge-silver {
      background: #c0c0c0;
      color: white;
    }

    .badge-gold {
      background: #ffd700;
      color: black;
    }

    .badge-platinum {
      background: #e5e4e2;
      color: black;
    }

    .stats-table {
      width: 100%;
      border-collapse: separate;
      border-spacing: 0;
      margin-top: 15px;
      border-radius: 12px;
      overflow: hidden;
      box-shadow: var(--shadow-md);
      background: var(--card-bg);
    }

    .stats-table th,
    .stats-table td {
      padding: 12px 16px;
      text-align: center;
      border-bottom: 1px solid var(--card-border);
      font-size: 0.9rem;
    }

    .stats-table th {
      background: var(--gradient-primary);
      color: white;
      font-weight: 700;
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .stats-table tr:last-child td {
      border-bottom: none;
    }

    .stats-table tr:hover {
      background: rgba(255, 255, 255, 0.05);
      cursor: pointer;
    }

    .stats-table .total {
      color: #2563eb;
      font-weight: 600;
    }

    .stats-table .done {
      color: #10b981;
      font-weight: 600;
    }

    .stats-table .pending {
      color: #ef4444;
      font-weight: 600;
    }

    .stats h2 {
      font-size: 1.3rem;
      margin-bottom: 10px;
      background: var(--gradient-secondary);
      -webkit-background-clip: text;
      background-clip: text;
      color: transparent;
    }

    .alert-box {
      background: rgba(239, 68, 68, 0.1);
      border: 1px solid var(--danger);
      border-radius: 10px;
      padding: 15px;
      margin-bottom: 20px;
      color: var(--text);
      position: relative;
    }

    .alert-box.warning {
      background: rgba(245, 158, 11, 0.1);
      border-color: var(--warning);
    }

    .alert-box i {
      margin-right: 10px;
    }

    .name-input-form {
      display: flex;
      flex-direction: column;
      gap: 15px;
      margin-bottom: 20px;
    }

    .name-input-form input {
      padding: 14px;
      border-radius: 10px;
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      outline: none;
      font-size: 1rem;
    }

    .name-input-form button {
      padding: 14px;
      border-radius: 10px;
      border: none;
      background: var(--gradient-primary);
      color: white;
      font-weight: 600;
      cursor: pointer;
    }

    .progress-bar {
      height: 10px;
      background: var(--text-muted);
      border-radius: 5px;
      overflow: hidden;
      margin-top: 10px;
    }

    .progress-bar-fill {
      height: 100%;
      background: var(--gradient-primary);
      transition: width 0.5s ease;
    }

    .badges-dropdown {
      margin-top: 20px;
      text-align: center;
    }

    .badges-dropdown select {
      padding: 10px;
      border-radius: 10px;
      background: var(--glass);
      color: var(--text);
      border: 1px solid var(--card-border);
    }

    .notes-section {
      margin-top: 20px;
    }

    .notes-section textarea {
      width: 100%;
      padding: 10px;
      border-radius: 10px;
      border: 1px solid var(--card-border);
      background: var(--glass);
      color: var(--text);
      outline: none;
      resize: vertical;
      min-height: 80px;
    }

    .notes-section button {
      margin-top: 10px;
      padding: 10px 20px;
      border-radius: 10px;
      border: none;
      background: var(--gradient-primary);
      color: white;
      font-weight: 600;
      cursor: pointer;
    }

    .notes-section ul {
      list-style: none;
      margin-top: 15px;
    }

    .notes-section li {
      background: var(--glass);
      border: 1px solid var(--glass-border);
      border-radius: 8px;
      padding: 10px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .notes-section li button {
      background: var(--danger);
      padding: 5px 10px;
      font-size: 0.8rem;
    }

    @media (max-width: 768px) {
      .action-buttons {
        flex-direction: column;
        gap: 10px;
      }

      .form-button, .submissions-button, .comment-button, .reply-button, .admin-button {
        width: 100%;
        justify-content: center;
      }
    }
  </style>
</head>
<body>
  <!-- Loading Overlay -->
  <div id="loading-overlay" class="hidden">
    <div class="loading-box">
      <div class="loading-spinner"></div>
      <h2 class="loading-title bangla-font">ডাটা লোড হচ্ছে<span class="loading-dots"></span></h2>
      <p class="loading-message bangla-font">দয়াকরে ডাটা লোড সম্পন্ন হওয়া পর্যন্ত অপেক্ষা করুন</p>
      <div class="loading-progress">
        <div class="loading-progress-bar" id="loading-progress-bar"></div>
      </div>
    </div>
  </div>

  <div id="login-page">
    <div class="login-container">
      <div class="welcome-message">
        <h1 class="bangla-font">ALIM-26 Final Stage Preparation Course</h1>
        <p class="bangla-font">শিক্ষার যাত্রায় এক নতুন দিগন্ত। বাংলাদেশ অনলাইন মাদ্রাসা (BOM) এর প্রাইভেট ব্যাচের আলিম-২৬ শিক্ষার্থীদের জন্য প্রিমিয়াম লার্নিং এক্সপেরিয়েন্স</p>
      </div>
      <div class="login-form">
        <div class="form-group">
          <label for="password" class="bangla-font">সিকিউরিটি কোড লিখুন</label>
          <input type="password" id="password" placeholder="এখানে কোডটি লিখুন" class="bangla-font">
        </div>
        <button class="login-btn bangla-font" onclick="checkPassword()">লগইন করুন</button>
        <div id="error-message" class="error-message bangla-font">সিকিউরিটি কোডটি ভুল হয়েছে। আবার চেষ্টা করুন।</div>
      </div>
      <div class="support-info">
        <p class="bangla-font">এক্সেস পাসওয়ার্ড পেতে BOM এর এডমিনের সাথে যোগাযোগ করুন</p>
        <a href="https://wa.me/8801806234120" class="whatsapp-link" target="_blank">
          <i class="fab fa-whatsapp"></i>
          <span>WhatsApp</span>
        </a>
      </div>
    </div>
  </div>
  <div id="main-page" style="display: none;">
    <header>
      <nav class="nav container">
        <div class="brand">
          <i class="fas fa-graduation-cap"></i>
          <span>ALIM-26 <br>
            <span class="tag">Final Stage Preparation Course</span></span>
        </div>
        <div class="searchbar">
          <i class="fas fa-search"></i>
          <input id="search-subjects" type="search" placeholder="সার্চ করুন যা দরকার🔎" class="dynamic-placeholder">
        </div>
        <div id="search-results"></div>
        <div class="controls">
          <button class="btn" id="refresh-data-btn"><i class="fas fa-sync-alt"></i> <span class="bangla-font">ডেটা রিফ্রেশ করুন</span></button>
          <button class="btn" id="dashboard-btn" style="display: none;"><i class="fas fa-tachometer-alt"></i> <span class="bangla-font">ড্যাশবোর্ড</span></button>
          <a class="btn" id="add-class-btn" href="https://docs.google.com/forms/d/e/1FAIpQLSfL0sFmx3IiTXCiFFraymOe65ITt6TqtTJVgjQln5dpAgk1oQ/viewform?usp=header" target="_blank" rel="noopener" style="display: none;"><i class="fas fa-plus-circle"></i> <span class="bangla-font">ক্লাস যুক্ত করুন</span></a>
        </div>
      </nav>
    </header>

    <!-- Notice Bars -->
    <div class="notice-bar bangla-font"><span><b>👉 জিন্স সাজেশন 'ক্লাসের লেকচার শীট' ফোল্ডারে আপলোড করা হয়েছে।</b></span></div>
    <div class="notice-bar bangla-font"><span><b>📢 বার্তা: প্রিয় শিক্ষার্থীরা, কমেন্টের রিপ্লাই সুবিধাটি বর্তমানে স্থগিত আছে। তবে আপনাদের প্রতিটি মতামত আমরা যত্নসহকারে পড়ছি এবং প্রয়োজনীয় পদক্ষেপ নিচ্ছি। আপনাদের মূল্যবান মতামত জানাতে থাকুন — আন্তরিক ধন্যবাদ সাথে থাকার জন্য!</b></span></div>

    <main class="container">
      <div class="hero fade-in">
        <h1 class="bangla-font">ALIM-26 "Final Stage Preparation Course"</h1>
        <p class="bangla-font">শিক্ষার যাত্রায় এক নতুন দিগন্ত। বাংলাদেশ অনলাইন মাদ্রাসা (BOM) এর প্রাইভেট ব্যাচের দাখিল-২৬ শিক্ষার্থীদের জন্য প্রিমিয়াম লার্নিং এক্সপেরিয়েন্স</p>
      </div>

      <!-- Clock -->
      <div class="clock-container fade-in">
        <div id="clock-time" class="clock-time"></div>
        <div id="clock-date" class="clock-date"></div>
        <div id="exam-countdown" class="bangla-font"></div>
      </div>

      <div class="stats">
        <div class="stat-card fade-in">
          <div class="stat-number">31</div>
          <div class="stat-label bangla-font">সাবজেক্ট</div>
        </div>
        <div class="stat-card fade-in">
          <div class="stat-number">120+</div>
          <div class="stat-label bangla-font">ক্লাস</div>
        </div>
        <div class="stat-card fade-in" id="exam-stats">
          <div class="stat-number">20+</div>
          <div class="stat-label bangla-font">ইক্সাম</div>
        </div>
        <div class="stat-card fade-in" id="mission-stats">
          <div class="stat-number">60+</div>
          <div class="stat-label bangla-font">মিশন</div>
        </div>
      </div>
      <div class="section-title">
        <h2 class="bangla-font">আজকের ক্লাস</h2>
      </div>
      <div id="today-classes">
        <div class="filter-bar">
          <select id="today-classes-sort">
            <option value="today" class="bangla-font">আজকের ক্লাস</option>
            <option value="week" class="bangla-font">সপ্তাহের ক্লাস</option>
            <option value="month" class="bangla-font">মাসের ক্লাস</option>
            <option value="all" class="bangla-font">সকল ক্লাস</option>
          </select>
        </div>
        <table class="today-classes-table">
          <thead>
            <tr>
              <th class="bangla-font">সাবজেক্ট</th>
              <th class="bangla-font">ক্লাসের শিরোনাম</th>
              <th class="bangla-font">তারিখ</th>
            </tr>
          </thead>
          <tbody id="today-classes-body">
            <tr>
              <td colspan="3" class="bangla-font" style="text-align: center; padding: 20px;">
                <div class="loading"></div> লোড হচ্ছে...
              </td>
            </tr>
          </tbody>
        </table>
      </div>
      <div class="section-title">
        <h2 class="bangla-font">সব সাবজেক্ট</h2>
      </div>
      <div class="subj-list">
        <a class="pill subject-link" href="#" data-name="কুরআন মাজীদ"><span><i class="fas fa-book-quran"></i> <span class="bangla-font">কুরআন মাজীদ</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="হাদীস ও উসূলুল হাদীস"><span><i class="fas fa-book"></i> <span class="bangla-font">হাদীস ও উসূলুল হাদীস</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="আল ফিকহ প্রথম পত্র"><span><i class="fas fa-balance-scale"></i> <span class="bangla-font">আল ফিকহ প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="আল ফিকহ দ্বিতীয় পত্র"><span><i class="fas fa-balance-scale"></i> <span class="bangla-font">আল ফিকহ দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="আরবি প্রথম পত্র"><span><i class="fas fa-language"></i> <span class="bangla-font">আরবি প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="আরবি দ্বিতীয় পত্র"><span><i class="fas fa-language"></i> <span class="bangla-font">আরবি দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="আরবি সাহিত্য"><span><i class="fas fa-book-open"></i> <span class="bangla-font">আরবি সাহিত্য</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="বালাগাত ও মানতিক"><span><i class="fas fa-brain"></i> <span class="bangla-font">বালাগাত ও মানতিক</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="বাংলা প্রথম পত্র"><span><i class="fas fa-font"></i> <span class="bangla-font">বাংলা প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="বাংলা দ্বিতীয় পত্র"><span><i class="fas fa-font"></i> <span class="bangla-font">বাংলা দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="ইংরেজি প্রথম পত্র"><span><i class="fas fa-font"></i> <span class="bangla-font">ইংরেজি প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="ইংরেজি দ্বিতীয় পত্র"><span><i class="fas fa-font"></i> <span class="bangla-font">ইংরেজি দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="ইসলামের ইতিহাস"><span><i class="fas fa-landmark"></i> <span class="bangla-font">ইসলামের ইতিহাস</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="তথ্য ও যোগাযোগ প্রযুক্তি"><span><i class="fas fa-laptop-code"></i> <span class="bangla-font">তথ্য ও যোগাযোগ প্রযুক্তি</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="পদার্থবিজ্ঞান প্রথম পত্র"><span><i class="fas fa-atom"></i> <span class="bangla-font">পদার্থবিজ্ঞান প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="পদার্থবিজ্ঞান দ্বিতীয় পত্র"><span><i class="fas fa-atom"></i> <span class="bangla-font">পদার্থবিজ্ঞান দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="রসায়ন প্রথম পত্র"><span><i class="fas fa-flask"></i> <span class="bangla-font">রসায়ন প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="রসায়ন দ্বিতীয় পত্র"><span><i class="fas fa-flask"></i> <span class="bangla-font">রসায়ন দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="জীববিজ্ঞান প্রথম পত্র"><span><i class="fas fa-dna"></i> <span class="bangla-font">জীববিজ্ঞান প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="জীববিজ্ঞান দ্বিতীয় পত্র"><span><i class="fas fa-dna"></i> <span class="bangla-font">জীববিজ্ঞান দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="অর্থনীতি প্রথম পত্র"><span><i class="fas fa-chart-line"></i> <span class="bangla-font">অর্থনীতি প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="অর্থনীতি দ্বিতীয় পত্র"><span><i class="fas fa-chart-line"></i> <span class="bangla-font">অর্থনীতি দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="পৌরনীতি ও সুশাসন প্রথম পত্র"><span><i class="fas fa-landmark"></i> <span class="bangla-font">পৌরনীতি ও সুশাসন প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="পৌরনীতি ও সুশাসন দ্বিতীয় পত্র"><span><i class="fas fa-landmark"></i> <span class="bangla-font">পৌরনীতি ও সুশাসন দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="উচ্চতর গণিত প্রথম পত্র"><span><i class="fas fa-calculator"></i> <span class="bangla-font">উচ্চতর গণিত প্রথম পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="উচ্চতর গণিত দ্বিতীয় পত্র"><span><i class="fas fa-calculator"></i> <span class="bangla-font">উচ্চতর গণিত দ্বিতীয় পত্র</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="মিশন"><span><i class="fas fa-bullseye"></i> <span class="bangla-font">মিশন</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="ইক্সাম"><span><i class="fas fa-file-alt"></i> <span class="bangla-font">ইক্সাম</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="ক্লাসের লেকচার শীট"><span><i class="fas fa-file-pdf"></i> <span class="bangla-font">ক্লাসের লেকচার শীট</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="পরীক্ষার রেজাল্ট শীট"><span><i class="fas fa-chart-bar"></i> <span class="bangla-font">পরীক্ষার রেজাল্ট শীট</span></span><span class="go bangla-font">খুলুন</span></a>
        <a class="pill subject-link" href="#" data-name="অন্যান্য"><span><i class="fas fa-ellipsis-h"></i> <span class="bangla-font">অন্যান্য</span></span><span class="go bangla-font">খুলুন</span></a>
      </div>

      <!-- Action Buttons -->
      <div class="action-buttons">
        <button class="form-button" id="form-button"><i class="fas fa-comment"></i> <span class="bangla-font">কমেন্ট করুন</span></button>
        <button class="submissions-button" id="submissions-button"><i class="fas fa-list"></i> <span class="bangla-font">সাবমিশন দেখুন</span></button>
      </div>
    </main>
    <div class="owner-wrap">
      <div class="owner-messages" aria-hidden="false">
        <span class="msg">crafted with care</span>
        <span class="msg">trusted mentor</span>
        <span class="msg">leading the roadmap</span>
        <span class="msg">for topper success</span>
      </div>
      <p class="owner-intro bangla-font">বাংলাদেশ অনলাইন মাদ্রাসা (BOM) এর প্রতিষ্ঠাতা এবং দূরদর্শী নেতা, যিনি শিক্ষার্থীদের উৎকর্ষের পথে পরিচালিত করছেন।</p>
      <div class="owner-name bangla-font">MD. RIAD HASAN<span style="font-weight:600; font-size:0.80rem; color:rgba(226,232,240,0.85); margin-left:8px;"><br>(CEO & Founder)</span></div>
      <div class="owner-sub">building brighter paths for ambitious learners</div>
      <div class="designer-credit">
        <span class="bangla-font" style="opacity:0.9;">design by</span>
        <span class="designer-name">SAHIBUL MUSA SIUM</span>
      </div>
    </div>
    <footer class="site-footer">
      © 2025 ALIM-26 Final Stage Preparation Course (BOM). All rights reserved.
    </footer>
  </div>
  <div id="subject-page" style="display: none;">
    <header>
      <nav class="nav container">
        <a class="brand back-button" href="#"><i class="fas fa-arrow-left"></i> <span class="bangla-font">সব সাবজেক্ট</span></a>
        <div class="filter-bar">
          <input id="search" type="search" placeholder="🔍 সার্চ...">
          <select id="sort">
            <option value="desc" class="bangla-font">নতুন থেকে পুরানো</option>
            <option value="asc" class="bangla-font">পুরানো থেকে নতুন</option>
          </select>
        </div>
      </nav>
    </header>
    <main class="container">
      <h2 id="subject-title" class="bangla-font"><i class="fas fa-book"></i> সাবজেক্ট</h2>
      <div id="classGrid" class="grid"></div>
    </main>
    <div class="owner-wrap">
      <div class="owner-messages" aria-hidden="false">
        <span class="msg">crafted with care</span>
        <span class="msg">trusted mentor</span>
        <span class="msg">leading the roadmap</span>
        <span class="msg">for topper success</span>
      </div>
      <p class="owner-intro bangla-font">বাংলাদেশ অনলাইন মাদ্রাসা (BOM) এর প্রতিষ্ঠাতা এবং দূরদর্শী নেতা, যিনি শিক্ষার্থীদের উৎকর্ষের পথে পরিচালিত করছেন।</p>
      <div class="owner-name bangla-font">MD. RIAD HASAN<span style="font-weight:600; font-size:0.80rem; color:rgba(226,232,240,0.85); margin-left:8px;"><br>(CEO & Founder)</span></div>
      <div class="owner-sub">building brighter paths for ambitious learners</div>
      <div class="designer-credit">
        <span class="bangla-font" style="opacity:0.9;">design by</span>
        <span class="designer-name">SAHIBUL MUSA SIUM</span>
      </div>
    </div>
    <footer class="site-footer">
      © 2025 ALIM-26 Final Stage Preparation Course (BOM). All rights reserved.
    </footer>
  </div>
  <div id="warning-modal" class="warning-modal">
    <div class="modal-content">
      <div class="modal-header">
        <h2 class="bangla-font">লগইন সফল হয়েছে!</h2>
      </div>
      <div class="modal-body">
        <p class="bangla-font">অনুগ্রহ করে নোট করুন: <br>BOM এর ওয়েবসাইটের এক্সেস তথ্য সর্বদা গোপনীয় রাখুন এবং কারোর সাথে পাসওয়ার্ড শেয়ার করবেন না।</p>
        <p class="bangla-font">যদি কোনো ব্যবহারকারীর পাসওয়ার্ড শেয়ার করতে দেখা যায়, তাহলে তাকে এই ওয়েবসাইট থেকে স্থায়ীভাবে নিষিদ্ধ করা হবে।</p>
      </div>
      <div class="modal-footer">
        <button class="modal-ok-btn bangla-font" onclick="closeWarningModal()">ঠিক আছে</button>
      </div>
    </div>
  </div>

  <!-- Name Set Modal -->
  <div class="modal" id="nameModal">
    <div class="modal-content">
      <button class="modal-close" onclick="hideNameModal()">×</button>
      <div class="modal-intro">
        <h2 class="bangla-font">নাম সেট করুন</h2>
        <p class="bangla-font">আপনার নাম লিখুন। এটি সেভ হয়ে যাবে এবং পরবর্তীতে কমেন্ট ও রিপ্লাই দেখার জন্য ব্যবহৃত হবে।</p>
        <div class="alert-box warning bangla-font">
          <i class="fas fa-exclamation-triangle"></i> দয়া করে আপনার পূর্ণ নাম ব্যবহার করুন, যাতে অন্য কারো সাথে নামের কোনো মিল না হয়। একটি স্বতন্ত্র এবং ব্যতিক্রমী নাম নির্বাচন করুন, যেন আপনার মতামত এবং উত্তর সঠিকভাবে সনাক্ত করা যায়।
        </div>
      </div>
      <div class="form-section">
        <form id="nameForm" onsubmit="saveName(event)">
          <label class="bangla-font" for="userName">নাম</label>
          <input type="text" id="userName" placeholder="আপনার পূর্ণ নাম লিখুন" required class="bangla-font">
          <button type="submit" class="submit-button bangla-font">সেভ করুন</button>
        </form>
      </div>
    </div>
  </div>

  <!-- Form Modal -->
  <div class="modal" id="formModal">
    <div class="modal-content">
      <button class="modal-close" onclick="hideForm()">×</button>
      <div class="modal-intro">
        <h2 class="bangla-font">আপনার মতামত আমাদের কাছে মূল্যবান</h2>
        <p class="bangla-font">প্রিয় শিক্ষার্থী, আমাদের শিক্ষামূলক ওয়েবসাইট আপনাদের শিক্ষা ও জ্ঞানার্জনের পথকে আরও সহজ ও ফলপ্রসূ করতে প্রতিশ্রুতিবদ্ধ। নিচের ফর্মটি পূরণ করুন।</p>
      </div>
      <div class="form-section">
        <form id="myForm" onsubmit="submitForm(event)">
          <label class="bangla-font" for="name">নাম</label>
          <input type="text" name="name" id="name" placeholder="আপনার নাম" required class="bangla-font" readonly><br>
          <label class="bangla-font" for="batch">ব্যাচ নাম</label>
          <select name="batch" id="batch" required class="bangla-font">
            <option value="" disabled selected class="bangla-font">ব্যাচ নির্বাচন করুন</option>
            <option value="Alim-26" class="bangla-font">আলিম-২৬</option>
          </select><br>
          <label class="bangla-font" for="message">মতামত/পরামর্শ/অভিযোগ</label>
          <textarea name="message" id="message" placeholder="আপনার মতামত লিখুন" required class="bangla-font"></textarea>
          <button type="submit" class="submit-button bangla-font" id="submitBtn">জমা দিন <span class="spinner"></span></button>
        </form>
      </div>
    </div>
  </div>

  <!-- Submissions Modal -->
  <div class="modal" id="submissionsModal">
    <div class="modal-content">
      <button class="modal-close" onclick="hideSubmissions()">×</button>
      <div class="modal-intro">
        <h2 class="bangla-font">সাবমিশন তালিকা</h2>
        <p class="bangla-font">এখানে সকল সাবমিশন দেখুন।</p>
      </div>
      <div id="submissions-list" class="submissions-list"></div>
    </div>
  </div>

  <!-- Dashboard Modal -->
  <div id="dashboard-modal" class="dashboard-modal">
    <div class="modal-content">
      <div class="modal-body" id="dashboard-body">
        <!-- ডাইনামিক কনটেন্ট এখানে লোড হবে -->
      </div>
    </div>
  </div>

  <div class="success-message" id="successMessage">ফর্ম সফলভাবে জমা হয়েছে!</div>
  <div id="notification" class="notification"></div>

  <script>
    // API URL
    const API_URL = "https://script.google.com/macros/s/AKfycbxbkM3I0Zp_Bqr4XJcjNB6A82h-RYGXUYq7oiNkmhAuJzslOYJtPjhNmuIIwJXTaCzgnA/exec";

    // Utility Functions
    function $(sel, root = document) { return root.querySelector(sel); }
    function $all(sel, root = document) { return Array.from(root.querySelectorAll(sel)); }

    let currentSubject = null;
    let highlightedClassTimestamp = null;
    const loginPage = $('#login-page');
    const mainPage = $('#main-page');
    const subjectPage = $('#subject-page');
    const warningModal = $('#warning-modal');
    let allClasses = [];

    const availableSubjects = [
      "কুরআন মাজীদ",
      "হাদীস ও উসূলুল হাদীস",
      "আল ফিকহ প্রথম পত্র",
      "আল ফিকহ দ্বিতীয় পত্র",
      "আরবি প্রথম পত্র",
      "আরবি দ্বিতীয় পত্র",
      "আরবি সাহিত্য",
      "বালাগাত ও মানতিক",
      "বাংলা প্রথম পত্র",
      "বাংলা দ্বিতীয় পত্র",
      "ইংরেজি প্রথম পত্র",
      "ইংরেজি দ্বিতীয় পত্র",
      "ইসলামের ইতিহাস",
      "তথ্য ও যোগাযোগ প্রযুক্তি",
      "পদার্থবিজ্ঞান প্রথম পত্র",
      "পদার্থবিজ্ঞান দ্বিতীয় পত্র",
      "রসায়ন প্রথম পত্র",
      "রসায়ন দ্বিতীয় পত্র",
      "জীববিজ্ঞান প্রথম পত্র",
      "জীববিজ্ঞান দ্বিতীয় পত্র",
      "অর্থনীতি প্রথম পত্র",
      "অর্থনীতি দ্বিতীয় পত্র",
      "পৌরনীতি ও সুশাসন প্রথম পত্র",
      "পৌরনীতি ও সুশাসন দ্বিতীয় পত্র",
      "উচ্চতর গণিত প্রথম পত্র",
      "উচ্চতর গণিত দ্বিতীয় পত্র",
      "মিশন",
      "ইক্সাম",
      "ক্লাসের লেকচার শীট",
      "পরীক্ষার রেজাল্ট শীট",
      "অন্যান্য"
    ];

    const LOGIN_EXPIRY_KEY = 'alim26_login_expiry';
    const IS_LOGGED_IN_KEY = 'alim26_is_logged_in';
    const USER_ROLE_KEY = 'alim26_user_role';

    function scrollToTop() {
      window.scrollTo({ top: 0, behavior: 'smooth' });
    }

    function setLoginExpiry(role) {
      const now = new Date();
      const oneMonthFromNow = new Date(now.setMonth(now.getMonth() + 1));
      localStorage.setItem(LOGIN_EXPIRY_KEY, oneMonthFromNow.getTime());
      localStorage.setItem(IS_LOGGED_IN_KEY, 'true');
      localStorage.setItem(USER_ROLE_KEY, role);
    }

    function checkLoginExpiry() {
      const expiryTime = localStorage.getItem(LOGIN_EXPIRY_KEY);
      const isLoggedIn = localStorage.getItem(IS_LOGGED_IN_KEY);

      if (!expiryTime || !isLoggedIn) {
        return false;
      }

      const now = new Date().getTime();
      return now < parseInt(expiryTime);
    }

    function getUserRole() {
      return localStorage.getItem(USER_ROLE_KEY) || 'user';
    }

    function logout() {
      localStorage.removeItem(LOGIN_EXPIRY_KEY);
      localStorage.removeItem(IS_LOGGED_IN_KEY);
      localStorage.removeItem(USER_ROLE_KEY);
      loginPage.style.display = 'flex';
      mainPage.style.display = 'none';
      subjectPage.style.display = 'none';
    }

    function showWarningModal() {
      warningModal.classList.add('show');
    }

    function closeWarningModal() {
      warningModal.classList.remove('show');
    }

    // Loading Overlay Functions
    function showLoadingOverlay() {
      const loadingOverlay = $('#loading-overlay');
      loadingOverlay.classList.remove('hidden');
    }

    function hideLoadingOverlay() {
      const loadingOverlay = $('#loading-overlay');
      loadingOverlay.classList.add('hidden');
    }

    function updateLoadingProgress(progress) {
      const progressBar = $('#loading-progress-bar');
      if (progressBar) {
        progressBar.style.width = `${progress}%`;
      }
    }

    function showNotification(message, isError = false, isWarning = false) {
      const notification = $('#notification');
      notification.innerHTML = `<i class="${isError ? 'fas fa-exclamation-circle' : isWarning ? 'fas fa-exclamation-triangle' : 'fas fa-check-circle'}"></i> <span class="bangla-font">${message}</span>`;
      notification.className = 'notification ' + (isError ? 'error' : isWarning ? 'warning' : 'success');
      notification.classList.add('show');

      setTimeout(() => {
        notification.classList.remove('show');
      }, 3000);
    }

    function checkPassword() {
      const password = $('#password').value;
      const errorElement = $('#error-message');

      if (password === 'USERALIM26') {
        setLoginExpiry('user');
        loginPage.style.display = 'none';
        mainPage.style.display = 'block';
        showWarningModal();
        loadInitialData();
        showDashboardButton();
        scrollToTop();
      } else if (password === 'OWNERALIM26') {
        setLoginExpiry('owner');
        loginPage.style.display = 'none';
        mainPage.style.display = 'block';
        showWarningModal();
        showAddClassButton();
        loadInitialData();
        scrollToTop();
      } else if (password === 'EDITOR@BOM-435') {
        setLoginExpiry('editor');
        loginPage.style.display = 'none';
        mainPage.style.display = 'block';
        showWarningModal();
        showAddClassButton();
        showDashboardButton();
        loadInitialData();
        scrollToTop();
      } else {
        errorElement.style.display = 'block';
        setTimeout(() => {
          errorElement.style.display = 'none';
        }, 3000);
      }
    }

    function showAddClassButton() {
      const addClassBtn = $('#add-class-btn');
      if (addClassBtn && (getUserRole() === 'owner' || getUserRole() === 'editor')) {
        addClassBtn.style.display = 'inline-flex';
      }
    }

    function showDashboardButton() {
      const dashboardBtn = $('#dashboard-btn');
      const role = getUserRole();
      if (role === 'user' || role === 'editor') {
        dashboardBtn.style.display = 'inline-flex';
      }
    }

    $('#password').addEventListener('keypress', function(e) {
      if (e.key === 'Enter') {
        checkPassword();
      }
    });

    function getDateFromTimestamp(timestamp) {
      if (!timestamp) return getTodayDate();

      try {
        const date = new Date(timestamp);
        if (!isNaN(date.getTime())) {
          const year = date.getFullYear();
          const month = String(date.getMonth() + 1).padStart(2, '0');
          const day = String(date.getDate()).padStart(2, '0');
          return `${year}-${month}-${day}`;
        }
        return getTodayDate();
      } catch (error) {
        console.error("Timestamp parsing error:", error, timestamp);
        return getTodayDate();
      }
    }

    function getTimeFromTimestamp(timestamp) {
      if (!timestamp) return '3:37 PM';

      try {
        const date = new Date(timestamp);
        if (!isNaN(date.getTime())) {
          const hours = date.getHours();
          const minutes = String(date.getMinutes()).padStart(2, '0');
          const period = hours >= 12 ? 'PM' : 'AM';
          const hour12 = hours % 12 || 12;
          return `${hour12}:${minutes} ${period}`;
        }
        return '3:37 PM';
      } catch (error) {
        console.error("Time parsing error:", error, timestamp);
        return '3:37 PM';
      }
    }

    function getTodayDate() {
      const today = new Date();
      const year = today.getFullYear();
      const month = String(today.getMonth() + 1).padStart(2, '0');
      const day = String(today.getDate()).padStart(2, '0');
      return `${year}-${month}-${day}`;
    }

    function formatDateToEnglish(dateStr) {
      if (!dateStr) return '';
      try {
        if (/^\d{4}-\d{2}-\d{2}$/.test(dateStr)) {
          const [year, month, day] = dateStr.split('-');
          return `${day}-${month}-${year.slice(2)}`;
        }
        return dateStr;
      } catch (error) {
        console.error("Date formatting error:", error, dateStr);
        return dateStr;
      }
    }

    // Clock Functionality
    function updateClock() {
      const now = new Date();
      const timeOptions = { hour: '2-digit', minute: '2-digit', second: '2-digit', hour12: true };
      const dateOptions = { year: 'numeric', month: 'long', day: 'numeric' };

      // Time and date in Bengali
      let timeStr = now.toLocaleTimeString('bn-BD', timeOptions);
      timeStr = timeStr.replace(/(AM|PM)/, '<small>$1</small>');
      const dateStr = now.toLocaleDateString('bn-BD', dateOptions);

      const clockTime = document.getElementById('clock-time');
      const clockDate = document.getElementById('clock-date');
      const examCountdown = document.getElementById('exam-countdown');

      if (clockTime && clockDate && examCountdown) {
        clockTime.innerHTML = timeStr;
        clockDate.textContent = dateStr;

        // Exam Countdown
        const examDate = new Date(2026, 1, 8);
        let diff = examDate - now;

        if (diff < 0) {
          examCountdown.textContent = 'পরীক্ষা শুরু হয়েছে!';
        } else {
          const months = Math.floor(diff / (1000 * 60 * 60 * 24 * 30));
          const days = Math.floor((diff % (1000 * 60 * 60 * 24 * 30)) / (1000 * 60 * 60 * 24));
          examCountdown.textContent = `বোর্ড পরীক্ষা শুরু: ${months} মাস ${days} দিন পর*`;
        }
      }
    }

    // Search Functionality
    function initDynamicPlaceholder() {
      const searchInput = $('#search-subjects');
      const placeholders = [
        'সার্চ করুন🔎',
        'কি খুজছেন?🤔',
        'সাজেশন্স🔥',
        'জিন্স সাজেশন্স💥',
        '👉ক্লাস',
        '💡মিশন',
        '👉ইক্সাম',
        'শীট🗞',
      ];
      
      let currentIndex = 0;
      
      function updatePlaceholder() {
        searchInput.placeholder = placeholders[currentIndex];
        currentIndex = (currentIndex + 1) % placeholders.length;
      }
      
      setInterval(updatePlaceholder, 4000);
      updatePlaceholder();
    }

    function renderSearchResults(results) {
      const container = $('#search-results');
      if (results.length === 0) {
        container.style.display = 'none';
        container.innerHTML = '';
        return;
      }
      
      container.style.display = 'flex';
      container.innerHTML = '';
      results.forEach(res => {
        const item = document.createElement('div');
        item.className = 'search-result-item';
        item.innerHTML = `<span class="title bangla-font">${res.title}</span><span class="subject bangla-font">(${res.subject})</span>`;
        item.addEventListener('click', () => {
          highlightedClassTimestamp = res.timestamp;
          showSubjectPage(res.subject, true);
          container.innerHTML = '';
          $('#search-subjects').value = '';
          container.style.display = 'none';
        });
        container.appendChild(item);
      });
    }

    function similarity(s1, s2) {
      s1 = s1.toLowerCase();
      s2 = s2.toLowerCase();
      const m = s1.length;
      const n = s2.length;
      const dp = Array.from({ length: m + 1 }, () => Array(n + 1).fill(0));
      for (let i = 0; i <= m; i++) dp[i][0] = i;
      for (let j = 0; j <= n; j++) dp[0][j] = j;
      for (let i = 1; i <= m; i++) {
        for (let j = 1; j <= n; j++) {
          const cost = s1[i - 1] === s2[j - 1] ? 0 : 1;
          dp[i][j] = Math.min(
            dp[i - 1][j] + 1,
            dp[i][j - 1] + 1,
            dp[i - 1][j - 1] + cost
          );
        }
      }
      const distance = dp[m][n];
      const maxLen = Math.max(m, n);
      return maxLen ? (maxLen - distance) / maxLen : 0;
    }

    function maxWordSimilarity(searchTerm, title) {
      const words = title.toLowerCase().split(/\s+/);
      let maxSim = 0;
      words.forEach(word => {
        const sim = similarity(searchTerm, word);
        if (sim > maxSim) maxSim = sim;
      });
      // Also check full title
      const fullSim = similarity(searchTerm, title.toLowerCase());
      return Math.max(maxSim, fullSim);
    }

    // Form and Comment Functionality
    const WEB_APP_URL = "https://script.google.com/macros/s/AKfycbzEX1EuBWpSMlZ9zbXs1lAVQkOTdeV779SsD6SF6RllQGMYxcHJu30p5BPzW7O-PAbysg/exec";
    let storedName = localStorage.getItem('userName') || '';

    function showNameModal() { 
      $('#nameModal').style.display = 'flex'; 
    }

    function hideNameModal() { 
      $('#nameModal').style.display = 'none'; 
    }

    function saveName(event) {
      event.preventDefault();
      const name = $('#userName').value.trim();
      if (name) {
        localStorage.setItem('userName', name);
        storedName = name;
        hideNameModal();
        showForm();
      } else {
        showNotification("নাম লিখুন!", true);
      }
    }

    function handleFormClick() {
      if (!storedName) {
        showNameModal();
      } else {
        showForm();
      }
    }

    function showForm() { 
      $('#formModal').style.display = 'flex'; 
      $('#myForm').reset(); 
      $('#name').value = storedName;
    }

    function hideForm() { 
      $('#formModal').style.display = 'none'; 
    }

    function showSubmissions() { 
      $('#submissionsModal').style.display = 'flex'; 
      $('#submissions-list').innerHTML = '<div style="text-align:center;padding:40px;color:var(--text-muted)" class="bangla-font">লোড হচ্ছে...</div>';
      loadSubmissions(); 
    }

    function hideSubmissions() { 
      $('#submissionsModal').style.display = 'none'; 
    }

    function submitForm(event) {
      event.preventDefault();
      const submitBtn = $('#submitBtn');
      submitBtn.classList.add('loading');
      submitBtn.disabled = true;
      const form = $('#myForm');
      const data = {
        name: form.name.value.trim(),
        batch: form.batch.value,
        message: form.message.value.trim()
      };

      fetch(WEB_APP_URL, {
        method: 'POST',
        body: JSON.stringify(data)
      })
      .then(res => res.text())
      .then(txt => {
        submitBtn.classList.remove('loading');
        submitBtn.disabled = false;
        if (txt.startsWith("Success")) {
          form.reset(); 
          hideForm(); 
          showSuccessMessage();
        } else {
          showNotification("ডেটা জমা হয়নি! আবার চেষ্টা করুন।", true);
        }
      })
      .catch(() => {
        submitBtn.classList.remove('loading');
        submitBtn.disabled = false;
        showNotification("ডেটা জমা হয়নি! আবার চেষ্টা করুন।", true);
      });
    }

    function showSuccessMessage() {
      const successMessage = $('#successMessage');
      successMessage.style.display = 'block';
      setTimeout(() => successMessage.style.display = 'none', 3000);
    }

    function loadSubmissions() {
      fetch(WEB_APP_URL + '?action=getSubmissions')
        .then(res => res.json())
        .then(data => {
          const list = $('#submissions-list');
          list.innerHTML = '';
          
          // শুধুমাত্র Alim-26 ব্যাচ ফিল্টার করুন
          const alim26Submissions = data.filter(item => 
            item.batch && item.batch.toString().toLowerCase().includes('alim-26')
          );
          
          // নতুন থেকে পুরানো সাজানো
          alim26Submissions.sort((a, b) => new Date(b.timestamp || b.time) - new Date(a.timestamp || a.time));
          
          if (alim26Submissions.length === 0) {
            list.innerHTML = '<div style="text-align:center;padding:40px;color:var(--text-muted)" class="bangla-font">Alim-26 ব্যাচের কোন সাবমিশন নেই</div>';
            return;
          }
          
          alim26Submissions.forEach(item => {
            const div = document.createElement('div');
            div.className = 'submission-item';
            div.innerHTML = `
              <div class="submission-name bangla-font">${item.name}</div>
              <div class="submission-batch bangla-font">ব্যাচ: ${item.batch}</div>
              <div class="submission-message bangla-font">${item.message}</div>
              ${item.reply ? `<div class="submission-reply bangla-font">উত্তর: ${item.reply}</div>` : ''}
              <div class="submission-time bangla-font">${item.time}</div>
            `;
            list.appendChild(div);
          });
        })
        .catch(() => showNotification("সাবমিশন লোড হয়নি! আবার চেষ্টা করুন।", true));
    }

    // Dashboard Functionality
    const STORAGE_KEYS = {
      STUDENT_NAME: 'alim26_student_name',
      JOIN_DATE: 'alim26_join_date',
      LAST_LOGIN: 'alim26_last_login',
      LAST_ACTIVITY: 'alim26_last_activity',
      COMPLETED_ITEMS: 'alim26_completed_items',
      NOTES: 'alim26_notes'
    };

    const motivationalQuotes = [
      "প্রতিদিনের ক্লাস প্রতিদিন করুন, সাফল্য আপনার কাছে আসবে! 🌟",
      "ছোট ছোট পদক্ষেপই বড় সাফল্যের পথ তৈরি করে! 💪",
      "নিয়মিত পড়াশোনা আপনাকে লক্ষ্যের কাছে নিয়ে যাবে! 🚀",
      "প্রতিটি ক্লাস আপনাকে এক ধাপ এগিয়ে নেয়! 🏆"
    ];

    const badges = [
      { name: 'Starter', threshold: 0, class: 'badge-starter', icon: '🏁' },
      { name: 'Bronze Cup', threshold: 30, class: 'badge-bronze', icon: '🥉' },
      { name: 'Silver Cup', threshold: 50, class: 'badge-silver', icon: '🥈' },
      { name: 'Gold Cup', threshold: 65, class: 'badge-gold', icon: '🥇' },
      { name: 'Platinum Trophy', threshold: 80, class: 'badge-platinum', icon: '🏆' }
    ];

    function saveStudentData(name, joinDate, lastLogin, lastActivity, completedItems) {
      localStorage.setItem(STORAGE_KEYS.STUDENT_NAME, name || 'শিক্ষার্থী');
      localStorage.setItem(STORAGE_KEYS.JOIN_DATE, joinDate || getTodayDate());
      localStorage.setItem(STORAGE_KEYS.LAST_LOGIN, lastLogin || new Date().toISOString());
      localStorage.setItem(STORAGE_KEYS.LAST_ACTIVITY, lastActivity || new Date().toISOString());
      localStorage.setItem(STORAGE_KEYS.COMPLETED_ITEMS, JSON.stringify(completedItems || []));
    }

    function getStudentData() {
      return {
        name: localStorage.getItem(STORAGE_KEYS.STUDENT_NAME) || 'শিক্ষার্থী',
        joinDate: localStorage.getItem(STORAGE_KEYS.JOIN_DATE) || getTodayDate(),
        lastLogin: localStorage.getItem(STORAGE_KEYS.LAST_LOGIN) || new Date().toISOString(),
        lastActivity: localStorage.getItem(STORAGE_KEYS.LAST_ACTIVITY) || new Date().toISOString(),
        completedItems: JSON.parse(localStorage.getItem(STORAGE_KEYS.COMPLETED_ITEMS)) || []
      };
    }

    // Tracking function
    window.trackItem = function(id, type) {
      const studentData = getStudentData();
      let completed = studentData.completedItems;
      if (completed.includes(id)) {
        return; // Already completed
      }

      if (type === 'class') {
        let scrolled = false;
        const scrollListener = () => { scrolled = true; };
        window.addEventListener('scroll', scrollListener);

        const minTime = 0;
        const maxTime = 0;
        const randomTime = Math.random() * (maxTime - minTime) + minTime;

        setTimeout(() => {
          window.removeEventListener('scroll', scrollListener);
          if (!scrolled) {
            completed.push(id);
            saveStudentData(studentData.name, studentData.joinDate, new Date().toISOString(), new Date().toISOString(), completed);
            showNotification(`${type} সম্পন্ন হয়েছে!`, false);
          } else {
            showNotification('পেজ স্ক্রল হয়েছে, সম্পন্ন মনে করা হয়নি।', true);
          }
        }, randomTime * 1000);
      } else {
        // For missions and exams, complete immediately
        completed.push(id);
        saveStudentData(studentData.name, studentData.joinDate, new Date().toISOString(), new Date().toISOString(), completed);
        showNotification(`${type} সম্পন্ন হয়েছে!`, false);
      }
    };

    function getItemsFromAllClasses() {
      // This function would normally get data from your actual classes
      // For demo purposes, we'll return dummy data
      return {
        classes: [
          { id: 'c1', addDate: '15-10-2024' },
          { id: 'c2', addDate: '16-10-2024' },
          { id: 'c3', addDate: '17-10-2024' }
        ],
        missions: [
          { id: 'm1', addDate: '15-10-2024' },
          { id: 'm2', addDate: '16-10-2024' }
        ],
        exams: [
          { id: 'e1', addDate: '20-10-2024' }
        ]
      };
    }

    function calculateStats(joinDate, completed) {
      const joinDateObj = parseDate(joinDate);
      const items = getItemsFromAllClasses();

      function parseDate(dateStr) {
        if (!dateStr) return new Date(0);
        const [day, month, year] = dateStr.split('-').map(Number);
        return new Date(year, month - 1, day);
      }

      function filterItems(itemList, isAfter) {
        return itemList.filter(item => {
          const addDateObj = parseDate(item.addDate);
          return isAfter ? addDateObj >= joinDateObj : addDateObj < joinDateObj;
        });
      }

      const afterClasses = filterItems(items.classes, true);
      const beforeClasses = filterItems(items.classes, false);
      const afterMissions = filterItems(items.missions, true);
      const beforeMissions = filterItems(items.missions, false);
      const afterExams = filterItems(items.exams, true);
      const beforeExams = filterItems(items.exams, false);

      const doneAfterClasses = afterClasses.filter(item => completed.includes(item.id)).length;
      const doneBeforeClasses = beforeClasses.filter(item => completed.includes(item.id)).length;
      const doneAfterMissions = afterMissions.filter(item => completed.includes(item.id)).length;
      const doneBeforeMissions = beforeMissions.filter(item => completed.includes(item.id)).length;
      const doneAfterExams = afterExams.filter(item => completed.includes(item.id)).length;
      const doneBeforeExams = beforeExams.filter(item => completed.includes(item.id)).length;

      const totalAll = items.classes.length + items.missions.length + items.exams.length;
      const totalCompleted = completed.length;
      const progress = totalAll > 0 ? (totalCompleted / totalAll) * 100 : 0;

      return {
        after: {
          totalClasses: afterClasses.length,
          doneClasses: doneAfterClasses,
          pendingClasses: afterClasses.length - doneAfterClasses,
          totalMissions: afterMissions.length,
          doneMissions: doneAfterMissions,
          pendingMissions: afterMissions.length - doneAfterMissions,
          totalExams: afterExams.length,
          doneExams: doneAfterExams,
          pendingExams: afterExams.length - doneAfterExams
        },
        before: {
          totalClasses: beforeClasses.length,
          doneClasses: doneBeforeClasses,
          pendingClasses: beforeClasses.length - doneBeforeClasses,
          totalMissions: beforeMissions.length,
          doneMissions: doneBeforeMissions,
          pendingMissions: beforeMissions.length - doneBeforeMissions,
          totalExams: beforeExams.length,
          doneExams: doneBeforeExams,
          pendingExams: beforeExams.length - doneBeforeExams
        },
        progress: progress.toFixed(1)
      };
    }

    function getCurrentBadge(progress) {
      for (let i = badges.length - 1; i >= 0; i--) {
        if (progress >= badges[i].threshold) {
          return badges[i];
        }
      }
      return badges[0];
    }

    function saveNotes(notes) {
      localStorage.setItem(STORAGE_KEYS.NOTES, JSON.stringify(notes));
    }

    function getNotes() {
      return JSON.parse(localStorage.getItem(STORAGE_KEYS.NOTES)) || [];
    }

    function renderNotes() {
      const notesList = $('#notes-list');
      const notes = getNotes();
      notesList.innerHTML = '';
      notes.forEach((note, index) => {
        const li = document.createElement('li');
        li.innerHTML = `
          <span class="bangla-font">${note}</span>
          <button onclick="deleteNote(${index})" class="bangla-font">মুছে ফেলুন</button>
        `;
        notesList.appendChild(li);
      });
    }

    window.deleteNote = function(index) {
      let notes = getNotes();
      notes.splice(index, 1);
      saveNotes(notes);
      renderNotes();
    };

    function showDashboard() {
      const studentData = getStudentData();
      const isNewUser = !localStorage.getItem(STORAGE_KEYS.STUDENT_NAME);
      const randomQuote = motivationalQuotes[Math.floor(Math.random() * motivationalQuotes.length)];
      const stats = calculateStats(studentData.joinDate, studentData.completedItems);
      const currentBadge = getCurrentBadge(stats.progress);
      const lastActivityDate = new Date(studentData.lastActivity);
      const daysSinceActivity = (new Date() - lastActivityDate) / (1000 * 60 * 60 * 24);

      const dashboardBody = $('#dashboard-body');
      dashboardBody.innerHTML = `
        ${isNewUser ? `
          <div class="alert-box success bangla-font">
            <i class="fas fa-info-circle"></i> আপনার নাম লিখুন এবং ড্যাশবোর্ড কাস্টমাইজ করুন!
          </div>
          <form class="name-input-form">
            <input type="text" id="student-name-input" placeholder="আপনার নাম লিখুন" class="bangla-font">
            <button type="submit" class="bangla-font">নাম সংরক্ষণ করুন</button>
          </form>
        ` : `
          <header class="modal-header bangla-font">
            <h2>স্বাগতম, ${studentData.name}!</h2>
            <div class="badge-current ${currentBadge.class}" id="current-badge">${currentBadge.icon} ${currentBadge.name}</div>
            <div id="close-btn" class="close-btn">✕</div>
          </header>

          <section class="motivation">
            <p id="motivation-text" class="bangla-font">${randomQuote}</p>
          </section>

          <section class="stats after-join bangla-font">
            <h2>জয়েন-এর পর</h2>
            <table class="stats-table">
              <thead>
                <tr>
                  <th>আইটেম</th>
                  <th>মোট</th>
                  <th>সম্পন্ন</th>
                  <th>বাকি</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>ক্লাস</td>
                  <td class="total">${stats.after.totalClasses}</td>
                  <td class="done">${stats.after.doneClasses}</td>
                  <td class="pending">${stats.after.pendingClasses}</td>
                </tr>
                <tr>
                  <td>মিশন</td>
                  <td class="total">${stats.after.totalMissions}</td>
                  <td class="done">${stats.after.doneMissions}</td>
                  <td class="pending">${stats.after.pendingMissions}</td>
                </tr>
                <tr>
                  <td>পরীক্ষা</td>
                  <td class="total">${stats.after.totalExams}</td>
                  <td class="done">${stats.after.doneExams}</td>
                  <td class="pending">${stats.after.pendingExams}</td>
                </tr>
              </tbody>
            </table>
          </section>

          <section class="stats before-join bangla-font">
            <h2>জয়েন-এর আগে</h2>
            <table class="stats-table">
              <thead>
                <tr>
                  <th>আইটেম</th>
                  <th>মোট</th>
                  <th>সম্পন্ন</th>
                  <th>বাকি</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td>ক্লাস</td>
                  <td class="total">${stats.before.totalClasses}</td>
                  <td class="done">${stats.before.doneClasses}</td>
                  <td class="pending">${stats.before.pendingClasses}</td>
                </tr>
                <tr>
                  <td>মিশন</td>
                  <td class="total">${stats.before.totalMissions}</td>
                  <td class="done">${stats.before.doneMissions}</td>
                  <td class="pending">${stats.before.pendingMissions}</td>
                </tr>
                <tr>
                  <td>পরীক্ষা</td>
                  <td class="total">${stats.before.totalExams}</td>
                  <td class="done">${stats.before.doneExams}</td>
                  <td class="pending">${stats.before.pendingExams}</td>
                </tr>
              </tbody>
            </table>
          </section>

          <section id="alarms" class="alarms bangla-font"></section>

          <section class="progress-section bangla-font">
            <h3>সম্মক অগ্রগতি</h3>
            <div class="progress-bar">
              <div class="progress-bar-fill" style="width: ${stats.progress}%"></div>
            </div>
            <p>${stats.progress}%</p>
          </section>

          <div class="badges-dropdown bangla-font">
            <label for="badges-select">ব্যাজসমূহ:</label>
            <select id="badges-select">
              ${badges.map(badge => `
                <option ${stats.progress >= badge.threshold ? '' : 'disabled'}>${badge.icon} ${badge.name} ${stats.progress >= badge.threshold ? '(প্রাপ্ত)' : '(লক)'}</option>
              `).join('')}
            </select>
          </div>

          <section class="notes-section bangla-font">
            <h3>আমার নোটস</h3>
            <textarea id="note-input" placeholder="নতুন নোট লিখুন..."></textarea>
            <button id="add-note-btn">নোট যোগ করুন</button>
            <ul id="notes-list"></ul>
          </section>
        `}
      `;

      if (isNewUser) {
        const form = dashboardBody.querySelector('.name-input-form');
        form.addEventListener('submit', (e) => {
          e.preventDefault();
          const nameInput = $('#student-name-input').value.trim();
          if (nameInput) {
            saveStudentData(nameInput, getTodayDate(), new Date().toISOString(), new Date().toISOString(), []);
            showNotification('নাম সফলভাবে সংরক্ষিত হয়েছে!', false);
            showDashboard();
          } else {
            showNotification('অনুগ্রহ করে একটি বৈধ নাম লিখুন', true);
          }
        });
      } else {
        // Update last login
        localStorage.setItem(STORAGE_KEYS.LAST_LOGIN, new Date().toISOString());

        // Alarms
        const alarms = $('#alarms');
        if (stats.before.pendingClasses + stats.before.pendingMissions + stats.before.pendingExams > 0) {
          alarms.innerHTML += `<div class="alert-box warning"><i class="fas fa-exclamation-triangle"></i> জয়েনের আগের ক্লাস, মিশন এবং পরীক্ষাগুলো নিজ দায়িত্বে সম্পন্ন করুন যতক্ষণ না সবগুলো শেষ হয়।</div>`;
        }
        if (daysSinceActivity > 7) {
          alarms.innerHTML += `<div class="alert-box warning"><i class="fas fa-exclamation-triangle"></i> আপনি টানা ১ সপ্তাহের বেশি ক্লাস করেননি! আজকের ক্লাস বক্সে গিয়ে সপ্তাহের ক্লাস সিলেক্ট করে প্রতিটা ক্লাস করে নিন।</div>`;
        }
        if (daysSinceActivity > 30) {
          alarms.innerHTML += `<div class="alert-box warning"><i class="fas fa-exclamation-triangle"></i> আপনি টানা ১ মাসের বেশি ক্লাস করেননি! আজকের ক্লাস বক্সে গিয়ে মাসের ক্লাস সিলেক্ট করে প্রতিটা ক্লাস করে নিন।</div>`;
        }
        if (stats.progress < 10 && !isNewUser) {
          alarms.innerHTML += `<div class="alert-box warning"><i class="fas fa-exclamation-triangle"></i> আপনার অগ্রগতি খুব কম! নিয়মিত ক্লাস করে অগ্রসর হোন।</div>`;
        }
        if (stats.after.pendingClasses > 5) {
          alarms.innerHTML += `<div class="alert-box warning"><i class="fas fa-exclamation-triangle"></i> জয়েনের পরের ক্লাসগুলোতে অনেক বাকি! দ্রুত সম্পন্ন করুন।</div>`;
        }

        // Close button
        const closeBtn = $('#close-btn');
        closeBtn.addEventListener('click', () => {
          const dashboardModal = $('#dashboard-modal');
          dashboardModal.classList.remove('show');
        });

        // Notes functionality
        renderNotes();
        const addNoteBtn = $('#add-note-btn');
        addNoteBtn.addEventListener('click', () => {
          const noteInput = $('#note-input');
          const noteText = noteInput.value.trim();
          if (noteText) {
            let notes = getNotes();
            notes.push(noteText);
            saveNotes(notes);
            renderNotes();
            noteInput.value = '';
            showNotification('নোট যোগ করা হয়েছে!', false);
          } else {
            showNotification('অনুগ্রহ করে নোট লিখুন', true);
          }
        });
      }

      const dashboardModal = $('#dashboard-modal');
      dashboardModal.classList.add('show');
    }

    // Main Website Functions
    function loadInitialData() {
      showLoadingOverlay();
      updateLoadingProgress(10);
      if (!checkLoginExpiry()) {
        logout();
        return;
      }

      fetchClasses();
      setupSubjectLinks();
      setupSearch();
      setupSort();
      setupBackButton();
      setupTodayClassesSort();
      $('#refresh-data-btn').addEventListener('click', handleRefreshClick);
      
      // Hide loading overlay after a short delay to ensure everything is loaded
      setTimeout(() => {
        hideLoadingOverlay();
        updateLoadingProgress(0);
      }, 100);
    }

    function fetchClasses(showNotificationFlag = false) {
      const todayClassesBody = $('#today-classes-body');
      todayClassesBody.innerHTML = `<tr><td colspan="3" class="bangla-font" style="text-align: center; padding: 20px;"><div class="loading"></div> ডেটা লোড হচ্ছে...</td></tr>`;

      return fetch(API_URL)
        .then(response => response.json())
        .then(data => {
          allClasses = data.rows.map(row => ({
            subject: row.subject || 'অন্যান্য',
            title: row.title || 'শিরোনাম নেই',
            timestamp: row.timestamp,
            link: row.link || '#'
          }));
          renderTodayClasses();
          showNotification(showNotificationFlag ? 'ডেটা সফলভাবে রিফ্রেশ করা হয়েছে!' : 'ডেটা সফলভাবে লোড হয়েছে!', false);
        })
        .catch(error => {
          console.error('Error fetching classes:', error);
          todayClassesBody.innerHTML = `<tr><td colspan="3" class="bangla-font" style="text-align: center; padding: 20px;">ডেটা লোড করতে সমস্যা হয়েছে। আবার চেষ্টা করুন।</td></tr>`;
          showNotification('ডেটা লোড করতে সমস্যা হয়েছে!', true);
        });
    }

    function handleRefreshClick() {
      const btn = $('#refresh-data-btn');
      const icon = btn.querySelector('i');
      const text = btn.querySelector('span');
      const originalText = text.innerHTML;
      btn.disabled = true;
      text.innerHTML = 'ডেটা রিফ্রেশ হচ্ছে...';
      icon.classList.add('fa-spin');

      showNotification('ডেটা রিফ্রেশ শুরু হচ্ছে...', false, true);

      fetchClasses(true).finally(() => {
        btn.disabled = false;
        text.innerHTML = originalText;
        icon.classList.remove('fa-spin');
      });
    }

    function renderTodayClasses(sortOption = 'today') {
      const todayClassesBody = $('#today-classes-body');
      const today = getTodayDate();
      let filteredClasses = allClasses;

      if (sortOption === 'today') {
        filteredClasses = allClasses.filter(cls => getDateFromTimestamp(cls.timestamp) === today);
      } else if (sortOption === 'week') {
        const oneWeekAgo = new Date();
        oneWeekAgo.setDate(oneWeekAgo.getDate() - 7);
        filteredClasses = allClasses.filter(cls => new Date(getDateFromTimestamp(cls.timestamp)) >= oneWeekAgo);
      } else if (sortOption === 'month') {
        const oneMonthAgo = new Date();
        oneMonthAgo.setMonth(oneMonthAgo.getMonth() - 1);
        filteredClasses = allClasses.filter(cls => new Date(getDateFromTimestamp(cls.timestamp)) >= oneMonthAgo);
      } else if (sortOption === 'all') {
        filteredClasses = allClasses;
      }

      if (filteredClasses.length === 0) {
        todayClassesBody.innerHTML = `
          <tr>
            <td colspan="3" class="empty-state bangla-font">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 20h9"></path>
                <path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
              </svg>
              কোনো ক্লাস পাওয়া যায়নি।
            </td>
          </tr>`;
        return;
      }

      filteredClasses.sort((a, b) => new Date(b.timestamp) - new Date(a.timestamp));

      todayClassesBody.innerHTML = filteredClasses.map(cls => {
        const date = formatDateToEnglish(getDateFromTimestamp(cls.timestamp));
        const time = getTimeFromTimestamp(cls.timestamp);
        const displayDate = sortOption === 'today' ? `${date} ${time}` : date;
        return `
          <tr class="class-row" data-timestamp="${cls.timestamp}" data-subject="${cls.subject}">
            <td><span class="subject-badge bangla-font">${cls.subject}</span></td>
            <td class="class-info bangla-font">${cls.title || 'শিরোনাম নেই'}</td>
            <td class="bangla-font">${displayDate}</td>
          </tr>`;
      }).join('');

      $all('.class-row', todayClassesBody).forEach(row => {
        row.addEventListener('click', () => {
          const subject = row.dataset.subject;
          const timestamp = row.dataset.timestamp;
          currentSubject = subject;
          highlightedClassTimestamp = timestamp;
          showSubjectPage(subject);
        });
      });
    }

    function setupTodayClassesSort() {
      const sortSelect = $('#today-classes-sort');
      sortSelect.addEventListener('change', () => {
        renderTodayClasses(sortSelect.value);
      });
    }

    function setupSubjectLinks() {
      const subjectLinks = $all('.subject-link');
      subjectLinks.forEach(link => {
        link.addEventListener('click', e => {
          e.preventDefault();
          currentSubject = link.dataset.name;
          highlightedClassTimestamp = null;
          showSubjectPage(currentSubject);
          scrollToTop();
        });
      });
    }

    function showSubjectPage(subject) {
      mainPage.style.display = 'none';
      subjectPage.style.display = 'block';
      $('#subject-title').innerHTML = `<i class="fas fa-book"></i> <span class="bangla-font">${subject}</span>`;
      renderClasses(subject);
    }

    function renderClasses(subject) {
      const classGrid = $('#classGrid');
      let filteredClasses = allClasses.filter(cls => cls.subject === subject);

      // Handle empty folders (no classes for the subject)
      if (filteredClasses.length === 0) {
        classGrid.innerHTML = `
          <div class="empty-state bangla-font">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 20h9"></path>
              <path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
            </svg>
            এই সাবজেক্টের জন্য কোনো ক্লাস পাওয়া যায়নি।
          </div>`;
        return;
      }

      const searchInput = $('#search').value.toLowerCase();
      const sortOption = $('#sort').value;

      // Apply search filter
      if (searchInput) {
        filteredClasses = filteredClasses.filter(cls => 
          cls.title.toLowerCase().includes(searchInput) || 
          cls.subject.toLowerCase().includes(searchInput)
        );
      }

      // Sort classes by timestamp (newest first by default)
      filteredClasses.sort((a, b) => {
        const dateA = new Date(a.timestamp || 0);
        const dateB = new Date(b.timestamp || 0);
        return dateB - dateA; // Newest first
      });

      // Assign serial numbers: oldest gets 1, newest gets highest
      const classesWithSerial = filteredClasses.map((cls, index, arr) => ({
        ...cls,
        serial: arr.length - index // Oldest (last in array) gets 1, increments upwards
      }));

      // Apply sort option for display (default: newest first)
      const displayClasses = sortOption === 'asc' 
        ? classesWithSerial.slice().reverse() // Oldest first for ascending
        : classesWithSerial; // Newest first for descending

      if (displayClasses.length === 0) {
        classGrid.innerHTML = `
          <div class="empty-state bangla-font">
            <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
              <path d="M12 20h9"></path>
              <path d="M16.5 3.5a2.12 2.12 0 0 1 3 3L7 19l-4 1 1-4L16.5 3.5z"></path>
            </svg>
            এই সাবজেক্টের জন্য কোনো ক্লাস পাওয়া যায়নি।
          </div>`;
        return;
      }

      classGrid.innerHTML = displayClasses.map(cls => {
        const date = formatDateToEnglish(getDateFromTimestamp(cls.timestamp));
        const time = getTimeFromTimestamp(cls.timestamp);
        const isHighlighted = highlightedClassTimestamp && cls.timestamp === highlightedClassTimestamp;
        const idPrefix = subject === 'মিশন' ? 'm' : subject === 'ইক্সাম' ? 'e' : 'c';
        const trackId = idPrefix + cls.serial;
        const onclickAttr = `onclick="trackItem('${trackId}', '${subject === 'মিশন' ? 'mission' : subject === 'ইক্সাম' ? 'exam' : 'class'}')"`;
        return `
          <div class="card ${isHighlighted ? 'highlight' : ''}">
            <div class="class-serial bangla-font">ক্লাস ${cls.serial}</div>
            <div class="subject bangla-font"><i class="fas fa-book"></i> ${cls.subject}</div>
            <div class="video-title bangla-font">${cls.title || 'শিরোনাম নেই'}</div>
            <div class="time bangla-font"><i class="fas fa-clock"></i> ${date} ${time}</div>
            <a href="${cls.link}" target="_blank" rel="noopener" class="btn bangla-font" ${onclickAttr}>
              <i class="fas fa-play-circle"></i> ভিডিও দেখুন
            </a>
          </div>`;
      }).join('');

      // Scroll to highlighted class if it exists
      if (highlightedClassTimestamp) {
        const highlightedCard = $all('.card.highlight', classGrid)[0];
        if (highlightedCard) {
          highlightedCard.scrollIntoView({ behavior: 'smooth', block: 'center' });
        }
      }
    }

    function setupSearch() {
      const searchInput = $('#search-subjects');
      const subjectLinks = $all('.subject-link');
      const searchResults = $('#search-results');
      
      searchInput.addEventListener('input', () => {
        const searchTerm = searchInput.value.trim().toLowerCase();
        
        // Clear results if search term is empty
        if (!searchTerm) {
          searchResults.innerHTML = '';
          searchResults.style.display = 'none';
          
          // Show all subjects
          subjectLinks.forEach(link => {
            link.style.display = '';
          });
          return;
        }
        
        // Search in classes
        const filtered = allClasses
          .map(cls => ({ ...cls, sim: maxWordSimilarity(searchTerm, cls.title) }))
          .filter(res => res.sim > 0.3)
          .sort((a, b) => b.sim - a.sim);
        
        renderSearchResults(filtered);
        
        // Also filter subjects
        const matchedSubjects = availableSubjects.filter(subject => 
          subject.toLowerCase().includes(searchTerm)
        );

        subjectLinks.forEach(link => {
          const subjectName = link.dataset.name;
          const shouldShow = matchedSubjects.includes(subjectName);
          link.style.display = shouldShow ? '' : 'none';
        });

        const subjList = $('.subj-list');
        if (matchedSubjects.length === 0) {
          subjList.innerHTML = `
            <div class="empty-state bangla-font">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <circle cx="11" cy="11" r="8"></circle>
                <line x1="21" y1="21" x2="16.65" y2="16.65"></line>
              </svg>
              কোনো সাবজেক্ট পাওয়া যায়নি।
            </div>`;
        } else {
          // Restore original subject list
          subjList.innerHTML = availableSubjects.map(subject => `
            <a class="pill subject-link" href="#" data-name="${subject}">
              <span><i class="fas fa-book"></i> <span class="bangla-font">${subject}</span></span>
              <span class="go bangla-font">খুলুন</span>
            </a>
          `).join('');
          setupSubjectLinks();
        }
      });

      const classSearchInput = $('#search');
      classSearchInput.addEventListener('input', () => {
        renderClasses(currentSubject);
      });
    }

    function setupSort() {
      const sortSelect = $('#sort');
      sortSelect.addEventListener('change', () => {
        renderClasses(currentSubject);
      });
    }

    function setupBackButton() {
      const backButton = $('.back-button');
      backButton.addEventListener('click', e => {
        e.preventDefault();
        subjectPage.style.display = 'none';
        mainPage.style.display = 'block';
        $('#search-subjects').value = '';
        const subjectLinks = $all('.subject-link');
        subjectLinks.forEach(link => link.style.display = '');
        scrollToTop();
      });
    }

    // Initialize everything when DOM is loaded
    document.addEventListener('DOMContentLoaded', function() {
      // Initialize clock
      updateClock();
      setInterval(updateClock, 1000);

      // Initialize dynamic placeholder
      initDynamicPlaceholder();

      // Initialize event listeners
      $('#form-button').addEventListener('click', handleFormClick);
      $('#submissions-button').addEventListener('click', showSubmissions);
      $('#dashboard-btn').addEventListener('click', showDashboard);

      // Modal close when clicking outside
      window.addEventListener('click', (e) => { 
        if (e.target == $('#nameModal')) hideNameModal(); 
        if (e.target == $('#formModal')) hideForm(); 
        if (e.target == $('#submissionsModal')) hideSubmissions(); 
        if (e.target == $('#dashboard-modal')) {
          const dashboardModal = $('#dashboard-modal');
          dashboardModal.classList.remove('show');
        }
      });

      // Initialize student data if not exists
      if (!localStorage.getItem(STORAGE_KEYS.STUDENT_NAME)) {
        saveStudentData('', getTodayDate(), new Date().toISOString(), new Date().toISOString(), []);
      }

      // Check login status on page load
      if (checkLoginExpiry()) {
        loginPage.style.display = 'none';
        mainPage.style.display = 'block';
        showAddClassButton();
        showDashboardButton();
        loadInitialData();
      } else {
        loginPage.style.display = 'flex';
        mainPage.style.display = 'none';
        subjectPage.style.display = 'none';
      }
    });
  </script>
</body>
</html>
